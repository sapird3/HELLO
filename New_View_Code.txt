{"columns":[{"key":"handle","csid":"handle","params":{}},{"key":"field","csid":"1","params":{"field":"issuekey"}},{"key":"main","csid":"main","params":{"description":false}},{"key":"formula","name":"PI Planning Status","csid":"50","params":{"formula":"// Feature Commitment\n// Note that the status field being used here is one of two in Jira.  You may need to select the correct Status for this to work properly.\nIF(type = \"Feature\",\n\tIF( \n\t\tmatch( Checklists, \"\"), \"{panel:borderStyle=solid|borderColor=white|bgColor=lightGrey}{color:white}No Teams Selected{color}{panel}\",\n//\t\tsearch(\"/\\+\\ [^\\[]/\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=orange}{color:white}Invalid Selection{color}{panel}\", \n\n\t\tsearch(\"/\\[CAN'T DO\\]/\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=\\#FFCBC1}{color:\\#bf2600}Can't Do{color}{panel}\", \n\t\tsearch(\"/~ /\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=\\#deebff}{color:\\#0747a6}In Progress{color}{panel}\", \n\t\tsearch(\"/[-–—] /\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=\\#e5e4e7}{color:\\#42526e}Not Ready{color}{panel}\", \n\t\tsearch(\"/\\[UNCOMMITTED\\]/\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=\\#fff0b3}{color:\\#172b4d}Uncommitted{color}{panel}\", \n\t\tsearch(\"/\\[COMMITTED\\]/\", Checklists), \"{panel:borderStyle=solid|borderColor=white|bgColor=\\#D5CDFF}{color:\\#403294}Committed{color}{panel}\", \n\n\t\t\"{panel:borderStyle=solid|borderColor=white|bgColor=Orange}{color:white}No Teams Selected{color}{panel}\"\n\t),\n\t// else not a feature\n\t( // this parenthesis is to organize the code block\n\n\t\tWITH count_features = COUNT#subtree#truthy{issuetype = \"Feature\"}:\n\n\t\tWITH count_cantdo = COUNT#subtree#truthy{issuetype = \"Feature\" AND match(Checklists, \"/\\[CAN'T DO\\]/\")}:\n\t\tWITH count_inprogress = COUNT#subtree#truthy{issuetype = \"Feature\" AND match(Checklists, \"/~ /\") AND NOT match(Checklists, \"/\\[CAN'T DO\\]/\")}:\n\t\tWITH count_notready = COUNT#subtree#truthy{issuetype = \"Feature\" AND match(Checklists, \"/[-–—] /\") AND NOT match(Checklists, \"/~ /\") AND NOT match(Checklists, \"/\\[CAN'T DO\\]/\")}:\n\t\tWITH count_uncommitted = COUNT#subtree#truthy{issuetype = \"Feature\" AND match(Checklists, \"/\\[UNCOMMITTED\\]/\") AND NOT match(Checklists, \"/[-–—] /\") AND NOT match(Checklists, \"/~ /\") AND NOT match(Checklists, \"/\\[CAN'T DO\\]/\")}:\n\t\tWITH count_committed = COUNT#subtree#truthy{issuetype = \"Feature\" AND match(Checklists, \"/\\[COMMITTED\\]/\") AND NOT match(Checklists, \"/\\[UNCOMMITTED\\]/\") AND NOT match(Checklists, \"/[-–—] /\") AND NOT match(Checklists, \"/~ /\") AND NOT match(Checklists, \"/\\[CAN'T DO\\]/\")}:\n\n\t\tIF(count_features > 0,\n\t\t\tCONCAT(\n\t\t\t\t\"{color:\\#D5CDFF}\", REPEAT(\"■\", ROUND(8 * count_committed / count_features)), \"{color}\",\n\t\t\t\t\"{color:\\#fff0b3}\", REPEAT(\"■\", ROUND(8 * count_uncommitted / count_features)), \"{color}\",\n\t\t\t\t\"{color:\\#FFCBC1}\", REPEAT(\"■\", ROUND(8 * count_cantdo / count_features)), \"{color}\",\n\t\t\t\t\"{color:\\#deebff}\", REPEAT(\"■\", ROUND(8 * count_inprogress / count_features)), \"{color}\",\n\t\t\t\t\"{color:\\#e5e4e7}\", REPEAT(\"■\", ROUND(8 * count_notready / count_features)), \"{color}\",\n\t\t\t\t\"{color:orange}\", REPEAT(\"■\", ROUND(8 * (count_features - count_cantdo - count_inprogress - count_notready - count_uncommitted - count_committed) / count_features)), \"{color}\"\n\t\t\t)\n\t\t)\n\t)\n)\n\n","normalizedFormula":"if(eq(type,\"Feature\"),if(match(checklists,\"\"),\"{panel:borderStyle=solid|borderColor=white|bgColor=lightGrey}{color:white}No Teams Selected{color}{panel}\",search(\"/\\\\[CAN'T DO\\\\]/\",checklists),\"{panel:borderStyle=solid|borderColor=white|bgColor=\\\\#FFCBC1}{color:\\\\#bf2600}Can't Do{color}{panel}\",search(\"/~ /\",checklists),\"{panel:borderStyle=solid|borderColor=white|bgColor=\\\\#deebff}{color:\\\\#0747a6}In Progress{color}{panel}\",search(\"/[-–—] /\",checklists),\"{panel:borderStyle=solid|borderColor=white|bgColor=\\\\#e5e4e7}{color:\\\\#42526e}Not Ready{color}{panel}\",search(\"/\\\\[UNCOMMITTED\\\\]/\",checklists),\"{panel:borderStyle=solid|borderColor=white|bgColor=\\\\#fff0b3}{color:\\\\#172b4d}Uncommitted{color}{panel}\",search(\"/\\\\[COMMITTED\\\\]/\",checklists),\"{panel:borderStyle=solid|borderColor=white|bgColor=\\\\#D5CDFF}{color:\\\\#403294}Committed{color}{panel}\",\"{panel:borderStyle=solid|borderColor=white|bgColor=Orange}{color:white}No Teams Selected{color}{panel}\"),with count_features=count#subtree#truthy{eq(issuetype,\"Feature\")}:with count_cantdo=count#subtree#truthy{and(eq(issuetype,\"Feature\"),match(checklists,\"/\\\\[CAN'T DO\\\\]/\"))}:with count_inprogress=count#subtree#truthy{and(eq(issuetype,\"Feature\"),match(checklists,\"/~ /\"),not(match(checklists,\"/\\\\[CAN'T DO\\\\]/\")))}:with count_notready=count#subtree#truthy{and(eq(issuetype,\"Feature\"),match(checklists,\"/[-–—] /\"),not(match(checklists,\"/~ /\")),not(match(checklists,\"/\\\\[CAN'T DO\\\\]/\")))}:with count_uncommitted=count#subtree#truthy{and(eq(issuetype,\"Feature\"),match(checklists,\"/\\\\[UNCOMMITTED\\\\]/\"),not(match(checklists,\"/[-–—] /\")),not(match(checklists,\"/~ /\")),not(match(checklists,\"/\\\\[CAN'T DO\\\\]/\")))}:with count_committed=count#subtree#truthy{and(eq(issuetype,\"Feature\"),match(checklists,\"/\\\\[COMMITTED\\\\]/\"),not(match(checklists,\"/\\\\[UNCOMMITTED\\\\]/\")),not(match(checklists,\"/[-–—] /\")),not(match(checklists,\"/~ /\")),not(match(checklists,\"/\\\\[CAN'T DO\\\\]/\")))}:if(gt(count_features,0),concat(\"{color:\\\\#D5CDFF}\",repeat(\"■\",round(div(mul(8,count_committed),count_features))),\"{color}\",\"{color:\\\\#fff0b3}\",repeat(\"■\",round(div(mul(8,count_uncommitted),count_features))),\"{color}\",\"{color:\\\\#FFCBC1}\",repeat(\"■\",round(div(mul(8,count_cantdo),count_features))),\"{color}\",\"{color:\\\\#deebff}\",repeat(\"■\",round(div(mul(8,count_inprogress),count_features))),\"{color}\",\"{color:\\\\#e5e4e7}\",repeat(\"■\",round(div(mul(8,count_notready),count_features))),\"{color}\",\"{color:orange}\",repeat(\"■\",round(div(mul(8,minus(minus(minus(minus(minus(count_features,count_cantdo),count_inprogress),count_notready),count_uncommitted),count_committed)),count_features))),\"{color}\")))","variables":{"type":{"id":"issuetype","format":"text"},"checklists":{"id":"customfield","params":{"fieldId":15011},"format":"text"},"issuetype":{"id":"issuetype","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16 Sprint Check","csid":"56","params":{"formula":"with sprintPattern = concat(\"/PI16_S/\"):\n\nWITH count_no_sprint = SUM{\n    IF((issuetype = \"User Story\" OR issuetype = \"Issue\") AND (status != \"Done\" AND status !=\"Cancelled\") AND (sprint = \"\" OR SEARCH(concat(\"/PI16_S/\"), Sprint) = 0 OR SEARCH(concat(\"/PI16_S/\"), Sprint) = undefined), 1, 0)\n}:\n\nIF( (issuetype = \"User Story\" OR issuetype = \"Issue\") AND (status != \"Done\" AND status !=\"Cancelled\") AND (sprint = \"\" OR SEARCH(sprintPattern, Sprint) = 0 OR SEARCH(sprintPattern, Sprint) = undefined), \n    concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=red}{color:white}\",\"No Sprint\",\"{color}{panel}\"),\n    (issuetype = \"User Story\" OR issuetype = \"Issue\"), \n        (\n            with startStr = Search(sprintPattern, Sprint):\n            with endStr = Search(\"/([\\s,]|$)/\", Sprint, startStr):\n            with piSprint = replace(trim(substring(Sprint,startStr-1,endStr)),\",\",\"\"):\n            IF(\n                Status = \"Done\", concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=grey}{color:white}\",\"Done\",\"{color}{panel}\"),\n                Status = \"Cancelled\", concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=grey}{color:white}\",\"Cancelled\",\"{color}{panel}\"),\n                concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",piSprint,\"{color}{panel}\")\n            )\n        ),\n        if(count_no_sprint > 0, \n            concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=red}{color:white}\",count_no_sprint,\"{color}{panel}\"), \n            concat(\"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",count_no_sprint,\"{color}{panel}\"))\n    )\n","variables":{"issuetype":{"id":"issuetype","format":"text"},"status":{"id":"status","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"Story Point Check","csid":"57","params":{"formula":"//\nWITH count_no_sp = SUM{\n    (issuetype = \"User Story\" OR issuetype = \"Issue\") \n        AND (status != \"Done\" and status !=\"Cancelled\") \n        AND (story_points = 0)\n}:\n\nWITH count_us_done = SUM{\n    (issuetype = \"User Story\" OR issuetype = \"Issue\") \n        AND (status = \"Done\" OR status =\"Cancelled\") \n}:\n\nWITH count_us_open = SUM{\n    (issuetype = \"User Story\" OR issuetype = \"Issue\") \n        AND (status != \"Done\" and status !=\"Cancelled\")\n}:\n\nWITH count_us_all = SUM{\n    (issuetype = \"User Story\" OR issuetype = \"Issue\") \n}:\n\nWITH display = IF(status != \"Done\" AND status != \"Cancelled\", \n    IF(issueType = \"Feature\" AND count_us_all = 0, IF(status = \"In Progress\",8,0), // No User Stores in the Feature\n       issueType = \"Feature\" AND count_us_open = 0, 8, // No User Stores in the Feature\n       issueType = \"Feature\" AND count_no_sp = 0, IF(status = \"PROPOSED\",7,1),\t// Feature is OK\n       issueType = \"Feature\" AND count_no_sp > 0, 2,\t// Show count of User Stories with No Story Points\n       (issuetype = \"User Story\" OR issuetype = \"Issue\"), IF(story_points = 0, 3, 4),\n       IF(count_no_sp = 0, 1, 2)),\n    IF(issueType = \"Feature\",5, 4)):\n\nIF( display = 0, '{panel:borderStyle=solid|borderColor=white|bgColor=red}{color:white}*No US*{color}{panel}',\n    display = 1, '{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}*OK*{color}{panel}',\n    display = 2, CONCAT('{panel:borderStyle=solid|borderColor=white|bgColor=red}{color:white}', count_no_sp, '{color}{panel}'),\n    display = 3, '{panel:borderStyle=solid|borderColor=white|bgColor=red}{color:white}*No SP*{color}{panel}', // '*(x)*',\n    display = 4, '*(/)*',\n    display = 5, '{panel:borderStyle=solid|borderColor=white|bgColor=grey}{color:white}*Closed*{color}{panel}',\n    display = 7, '{panel:borderStyle=solid|borderColor=white|bgColor=orange}{color:white}*Ready*{color}{panel}',\n    display = 8, '{panel:borderStyle=solid|borderColor=white|bgColor=yellow}{color:red}*Ready to Close?*{color}{panel}',\n    \"\")\n","variables":{"issuetype":{"id":"issuetype","format":"text"},"status":{"id":"status","format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"Scrum Team","csid":"53","params":{"formula":"// Update this based on your ART\nWITH reviewing_art = \"Foundation\":\n\n// Foundation\n// Advanced Instruments\n// Core Instruments\n// Released Product Engineering\n// Shared Services\n// Outside ART\n\nWITH story_view = IF(DEFINED(art_scrum_team),\n\n    WITH divider = SEARCH(\"/-/\", art_scrum_team):\n\n    // If the divider is missing, we just have the ART\n    WITH art = IF(divider = undefined, art_scrum_team,\n        SUBSTRING(art_scrum_team, 0, divider - 2)):\n    WITH team = IF(divider = undefined, \"{color:red}_undefined_{color}\",\n        SUBSTRING(art_scrum_team, divider + 1)):\n\n    // Trim down long scrum team names to 12 characters\n    WITH team = CASE(team,\n        \"Astra NPS Developers\", \"Astra Dev\",\n        \"Souper Troopers\", \"Souper Trprs\",\n        \"Storm Chasers 1\", \"Strm Chsrs 1\",\n        \"Storm Chasers 2\", \"Strm Chsrs 2\",\n        \"Scrumbledores\", \"Scrumbldores\",\n        \"Infrawarriors\", \"Infrawariors\",\n        \"Astra NPS Validators\", \"Astra Val\",\n        team):\n\n    // Show the team before the ART to simplify shortening the column\n    CONCAT(team, \n        IF(art = reviewing_art, \" {color:silver}_- \", \" {color:red}_- \"), \n        art, \n        \"_{color}\")\n):\n\nwith summary_view = IF(NOT(DEFINED(art_scrum_team)),\n    // Find the \"sum ART\" over all the subtickets\n    WITH sum_art = SUM{IF(DEFINED(art_scrum_team),\n        WITH divider = SEARCH(\"/-/\", art_scrum_team):\n\n        // If the divider is missing, we just have the ART\n        WITH art = IF(divider = undefined, art_scrum_team,\n            SUBSTRING(art_scrum_team, 0, divider - 2)):\n\n        // Use large numbers for the average to reduce the likelihood of accidentally matching\n        // e.g., with small numbers, MOD(1 + 3, 2) = 0, which would be wrong\n        // when the number of tickets is smaller than these numbers, there's lower likelihood of matching.\n        //\n        // Ideally we could do more advanced agregation functions, like foldl or foldr,\n        // but Jira Structure doesn't offer that capability.\n        //\n        // HACK -- not clear whether this algorithm will typically guarantee no false matches\n        CASE(art,\n            \"Foundation\", 100003,\n            \"Advanced Instruments\", 100019,\n            \"Core Instruments\", 100043,\n            \"Released Product Engineering\", 100049,\n            \"Shared Services\", 100057,\n            \"Outside ART\", 100069,\n            100103\n        )\n    )}:\n\n    with art_name = IF(\n        sum_art = undefined, \"\",\n        MOD(sum_art, 100003) = 0, \"Foundation\",\n        MOD(sum_art, 100019) = 0, \"Advanced Instruments\",\n        MOD(sum_art, 100043) = 0, \"Core Instruments\",\n        MOD(sum_art, 100049) = 0, \"Released Product Engineering\",\n        MOD(sum_art, 100057) = 0, \"Shared Services\",\n        MOD(sum_art, 100069) = 0, \"Outside ART\",\n        \"Multiple ARTs\"\n    ):\n\n    CONCAT(IF(art_name = reviewing_art, \"{color:silver}\", \"{color:#FFC0C0}\"),\n        art_name,\n        \"{color}\")\n):\n\nIF(DEFINED(art_scrum_team), story_view, summary_view)","variables":{"art_scrum_team":{"id":"customfield","params":{"fieldId":15543},"format":"text"}},"displayFormat":{"type":"wiki"},"normalizedFormula":"with reviewing_art=\"Foundation\":with story_view=if(defined(art_scrum_team),with divider=search(\"/-/\",art_scrum_team):with art=if(eq(divider,undefined),art_scrum_team,substring(art_scrum_team,0,minus(divider,2))):with team=if(eq(divider,undefined),\"{color:red}_undefined_{color}\",substring(art_scrum_team,sum(divider,1))):with team=case(team,\"Astra NPS Developers\",\"Astra Dev\",\"Souper Troopers\",\"Souper Trprs\",\"Storm Chasers 1\",\"Strm Chsrs 1\",\"Storm Chasers 2\",\"Strm Chsrs 2\",\"Scrumbledores\",\"Scrumbldores\",\"Infrawarriors\",\"Infrawariors\",\"Astra NPS Validators\",\"Astra Val\",team):concat(team,if(eq(art,reviewing_art),\" {color:silver}_- \",\" {color:red}_- \"),art,\"_{color}\")):with summary_view=if(not(defined(art_scrum_team)),with sum_art=sum{if(defined(art_scrum_team),with divider=search(\"/-/\",art_scrum_team):with art=if(eq(divider,undefined),art_scrum_team,substring(art_scrum_team,0,minus(divider,2))):case(art,\"Foundation\",100003,\"Advanced Instruments\",100019,\"Core Instruments\",100043,\"Released Product Engineering\",100049,\"Shared Services\",100057,\"Outside ART\",100069,100103))}:with art_name=if(eq(sum_art,undefined),\"\",eq(mod(sum_art,100003),0),\"Foundation\",eq(mod(sum_art,100019),0),\"Advanced Instruments\",eq(mod(sum_art,100043),0),\"Core Instruments\",eq(mod(sum_art,100049),0),\"Released Product Engineering\",eq(mod(sum_art,100057),0),\"Shared Services\",eq(mod(sum_art,100069),0),\"Outside ART\",\"Multiple ARTs\"):concat(if(eq(art_name,reviewing_art),\"{color:silver}\",\"{color:#FFC0C0}\"),art_name,\"{color}\")):if(defined(art_scrum_team),story_view,summary_view)"}},{"key":"formula","name":"Pre-PI16","csid":"55","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n\n    with scheduledPreviousPI = (\n        // To figure out whether something was scheduled in previous PI, we look look at each digit of the PI\n        // To simplify our analysis, we assume this PI is two-digit.\n        //\n        // (1) Anything with a one-digit PI is from the previous PI\n        // (2) Anything with a two-digit PI (of form AB) is from the previous PI if\n        //   (i) A < X, e.g., PI is 21 and previous PI is 12\n        //   (ii) A = X and B < Y, e.g., PI is 11 and previous PI is 10\n\n        with single_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            \"/PI\\d[_\\-](S|SP)\\d[_\\-]/\"\n        ):\n\n        with upper_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            LEFT(PI_number, 1) <= 1, \"do not match\",\n            CONCAT(\"/PI[1-\", LEFT(PI_number, 1) - 1, \"]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            RIGHT(PI_number, 1) = 0, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[0-\", RIGHT(PI_number, 1) - 1, \"][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        MATCH(sprint, single_pi_search)\n            OR MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n    ):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (scheduledPreviousPI) \n        AND ((NOT DEFINED(story_points)) OR story_points = 0) \n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith summary_status = (\n    with total_sp = SUM{\n        with PI_number = 16:\n\n        with scheduledPreviousPI = (\n            // To figure out whether something was scheduled in previous PI, we look look at each digit of the PI\n            // To simplify our analysis, we assume this PI is two-digit.\n            //\n            // (1) Anything with a one-digit PI is from the previous PI\n            // (2) Anything with a two-digit PI (of form AB) is from the previous PI if\n            //   (i) A < X, e.g., PI is 21 and previous PI is 12\n            //   (ii) A = X and B < Y, e.g., PI is 11 and previous PI is 10\n\n            with single_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                \"/PI\\d[_\\-](S|SP)\\d[_\\-]/\"\n            ):\n\n            with upper_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                LEFT(PI_number, 1) <= 1, \"do not match\",\n                CONCAT(\"/PI[1-\", LEFT(PI_number, 1) - 1, \"]\\d[_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            with lower_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                RIGHT(PI_number, 1) = 0, \"do not match\",\n                CONCAT(\"/PI\", LEFT(PI_number, 1), \"[0-\", RIGHT(PI_number, 1) - 1, \"][_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            MATCH(sprint, single_pi_search)\n                OR MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n        ):\n\n        IF(scheduledPreviousPI AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    with done_sp = SUM{\n        with PI_number = 16:\n\n        with scheduledPreviousPI = (\n            // To figure out whether something was scheduled in previous PI, we look look at each digit of the PI\n            // To simplify our analysis, we assume this PI is two-digit.\n            //\n            // (1) Anything with a one-digit PI is from the previous PI\n            // (2) Anything with a two-digit PI (of form AB) is from the previous PI if\n            //   (i) A < X, e.g., PI is 21 and previous PI is 12\n            //   (ii) A = X and B < Y, e.g., PI is 11 and previous PI is 10\n\n            with single_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                \"/PI\\d[_\\-](S|SP)\\d[_\\-]/\"\n            ):\n\n            with upper_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                LEFT(PI_number, 1) <= 1, \"do not match\",\n                CONCAT(\"/PI[1-\", LEFT(PI_number, 1) - 1, \"]\\d[_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            with lower_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                RIGHT(PI_number, 1) = 0, \"do not match\",\n                CONCAT(\"/PI\", LEFT(PI_number, 1), \"[0-\", RIGHT(PI_number, 1) - 1, \"][_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            MATCH(sprint, single_pi_search)\n                OR MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n        ):\n\n        with scheduledCurrentOrFuturePI = (\n            // To figure out whether something was scheduled in current or future PI, we look look at each digit of the PI\n            // To simplify our analysis, we assume this PI is two-digit.\n            //\n            // Anything with a two-digit PI (of form AB) is from the current or future PI if\n            //   (i) A > X, e.g., PI is 12 and future PI is 22\n            //   (ii) A = X and B >= Y, e.g., PI is 11 and future PI is 12\n\n            with upper_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                LEFT(PI_number, 1) = 9, \"do not match\",\n                CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            with lower_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                // No need to limit on the second number, e.g. PI19 would work because [9-9] would match\n                // RIGHT(PI_number, 1) = 0, \"do not match\",\n                CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1), \"-9][_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n        ):\n\n        IF(DEFINED(resolution)\n            // We have a handful of \"messed up\" tickets non-stories that possess properties they shouldn't have\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND scheduledPreviousPI\n            AND NOT scheduledCurrentOrFuturePI, \n            story_points, \n            0\n        )\n    }:\n\n    with any_unresolved_and_unscheduled = SUM{\n        // Unfortunately Jira Structure does not support custom functions, so this is just a copy-paste of other code\n        with PI_number = 16:\n\n        with scheduledPreviousPI = (\n            // To figure out whether something was scheduled in previous PI, we look look at each digit of the PI\n            // To simplify our analysis, we assume this PI is two-digit.\n            //\n            // (1) Anything with a one-digit PI is from the previous PI\n            // (2) Anything with a two-digit PI (of form AB) is from the previous PI if\n            //   (i) A < X, e.g., PI is 21 and previous PI is 12\n            //   (ii) A = X and B < Y, e.g., PI is 11 and previous PI is 10\n\n            with single_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                \"/PI\\d[_\\-](S|SP)\\d[_\\-]/\"\n            ):\n\n            with upper_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                LEFT(PI_number, 1) <= 1, \"do not match\",\n                CONCAT(\"/PI[1-\", LEFT(PI_number, 1) - 1, \"]\\d[_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            with lower_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                RIGHT(PI_number, 1) = 0, \"do not match\",\n                CONCAT(\"/PI\", LEFT(PI_number, 1), \"[0-\", RIGHT(PI_number, 1) - 1, \"][_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            MATCH(sprint, single_pi_search)\n                OR MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n        ):\n\n        with scheduledCurrentOrFuturePI = (\n            // To figure out whether something was scheduled in current or future PI, we look look at each digit of the PI\n            // To simplify our analysis, we assume this PI is two-digit.\n            //\n            // Anything with a two-digit PI (of form AB) is from the current or future PI if\n            //   (i) A > X, e.g., PI is 12 and future PI is 22\n            //   (ii) A = X and B >= Y, e.g., PI is 11 and future PI is 12\n\n            with upper_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                LEFT(PI_number, 1) = 9, \"do not match\",\n                CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            with lower_pi_search = IF(\n                PI_number < 10 OR PI_number > 99, \"do not match\",\n                // No need to limit on the second number, e.g. PI19 would work because [9-9] would match\n                // RIGHT(PI_number, 1) = 0, \"do not match\",\n                CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1), \"-9][_\\-](S|SP)\\d[_\\-]/\")\n            ):\n\n            MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n        ):        \n\n        // We have a handful of \"messed up\" tickets non-stories that possess properties they shouldn't have\n        (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND scheduledPreviousPI \n            AND NOT scheduledCurrentOrFuturePI\n            AND (status != \"Done\" AND status != \"Cancelled\")\n    }:\n\n    with highlight = any_unresolved_and_unscheduled:\n\n    with demphasize_ratio = NOT highlight AND (done_sp = 0) AND (total_sp = 0) AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(highlight, \"{color:red}\"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\"),\n        IF(highlight, \"{color}\")\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n\n    with scheduledPreviousPI = (\n        // To figure out whether something was scheduled in previous PI, we look look at each digit of the PI\n        // To simplify our analysis, we assume this PI is two-digit.\n        //\n        // (1) Anything with a one-digit PI is from the previous PI\n        // (2) Anything with a two-digit PI (of form AB) is from the previous PI if\n        //   (i) A < X, e.g., PI is 21 and previous PI is 12\n        //   (ii) A = X and B < Y, e.g., PI is 11 and previous PI is 10\n\n        with single_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            \"/PI\\d[_\\-](S|SP)\\d[_\\-]/\"\n        ):\n\n        with upper_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            LEFT(PI_number, 1) <= 1, \"do not match\",\n            CONCAT(\"/PI[1-\", LEFT(PI_number, 1) - 1, \"]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            RIGHT(PI_number, 1) = 0, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[0-\", RIGHT(PI_number, 1) - 1, \"][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        MATCH(sprint, single_pi_search)\n            OR MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n    ):\n\n    with scheduledCurrentOrFuturePI = (\n        // To figure out whether something was scheduled in current or future PI, we look look at each digit of the PI\n        // To simplify our analysis, we assume this PI is two-digit.\n        //\n        // Anything with a two-digit PI (of form AB) is from the current or future PI if\n        //   (i) A > X, e.g., PI is 12 and future PI is 22\n        //   (ii) A = X and B >= Y, e.g., PI is 11 and future PI is 12\n\n        with upper_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10 OR PI_number > 99, \"do not match\",\n            // No need to limit on the second number, e.g. PI19 would work because [9-9] would match\n            // RIGHT(PI_number, 1) = 0, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1), \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n    ):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledPreviousPI,\n            IF(scheduledCurrentOrFuturePI, 5,\n                // otherwise, it was _only_ scheduled in the past\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's not done and was just scheduled in the past, which is a problem\n                4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}✔\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}✔\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}⚑\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:red}✘\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        IF(result != 0, \"{color}{panel}\")\n    )\n):\n\nIF(issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    summary_status\n)\n","displayFormat":{"type":"wiki"},"variables":{"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"issuetype":{"id":"issuetype","format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"resolution":{"id":"resolution","format":"text"}}}},{"key":"formula","name":"PI16_S1","csid":"44","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 1:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-07-29'):\n    with sprint_end_date = DATE('2024-08-12'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 1:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 1:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 1:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 1:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16_S2","csid":"45","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 2:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-08-12'):\n    with sprint_end_date = DATE('2024-08-26'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 2:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 2:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 2:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 2:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16_S3","csid":"46","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 3:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-08-26'):\n    with sprint_end_date = DATE('2024-09-09'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 3:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 3:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 3:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 3:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16_S4","csid":"47","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 4:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-09-09'):\n    with sprint_end_date = DATE('2024-09-23'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 4:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 4:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 4:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 4:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16_S5","csid":"48","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 5:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-09-23'):\n    with sprint_end_date = DATE('2024-10-07'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 5:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 5:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 5:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 5:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"PI16_S6","csid":"49","params":{"formula":"// WARNING: when updating this, you will need to edit the PI_number and sprint_number in multiple spots\n\nwith any_sp_undefined = SUM{\n    with PI_number = 16:\n    with sprint_number = 6:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n    (issuetype = \"Issue\" OR issuetype = \"User Story\")\n        AND (MATCH(Sprint, thisSprintPattern))\n        AND ((NOT DEFINED(story_points)) OR story_points = 0)\n        AND (status != \"Cancelled\" AND status != \"Done\")\n}:\n\nwith any_added_scope_this_sprint = SUM{\n    with sprint_start_date = DATE('2024-10-07'):\n    with sprint_end_date = DATE('2024-10-21'):\n\n    (created >= sprint_start_date AND created < sprint_end_date)\n        AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n}:\n\nwith summary_status = (\n\n    // count total SPs, regardless of whether it was completed or not\n    with total_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 6:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        IF(MATCH(Sprint, thisSprintPattern) AND (issuetype = \"Issue\" OR issuetype = \"User Story\"), \n            story_points, 0)\n    }:\n\n    // count done SPs only if it's completed, and not in a future sprint or PI\n    with done_sp = SUM{\n        with PI_number = 16:\n        with sprint_number = 6:\n        with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        IF(DEFINED(resolution)\n            AND (issuetype = \"Issue\" OR issuetype = \"User Story\")\n            AND MATCH(sprint, thisSprintPattern)\n            AND NOT (MATCH(sprint, upper_pi_search)\n                OR MATCH(sprint, lower_pi_search)\n                OR MATCH(sprint, sprint_search)\n            ), story_points, \n            // otherwise\n            0\n        )\n    }:\n\n    with demphasize_ratio = (done_sp = 0) AND (total_sp = 0) \n        AND NOT any_sp_undefined:\n\n    CONCAT(\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        IF(demphasize_ratio, \"{color:silver}_\"), \n        done_sp, \" / \", \n        total_sp,\n        IF(any_sp_undefined, \"*\"),\n        IF(demphasize_ratio, \"_{color}\")\n    )\n):\n\nwith feature_status = (\n    with PI_number = 16:\n    with sprint_number = 6:\n\n    with planned_for_regex = CONCAT(\"/.*PlannedForPI\", PI_number, \"_S\", sprint_number, \".*/\"):\n\n    with planned_highlight = MATCH(labels, planned_for_regex):\n\n    CONCAT(\n        IF(planned_highlight, \"{color:green}⚑ {color}\"),\n        summary_status\n    )\n):\n\nwith issue_status = (\n    with PI_number = 16:\n    with sprint_number = 6:\n    with thisSprintPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\", sprint_number, \"[_\\-]/\"):\n    with sprintThisPIPattern = CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)\\d+[_\\-]/\"):\n\n    with scheduledFutureSprint = (\n        // in future PI\n        // let XY = PI, where X is upper digit and Y is lower digit => if Y < 9, then /X [Y+1 - 9]/; if X < 9, then /[X+1 - 9] \\d/\n        // this approach only works for PIs with two digits, i.e. 10 through 99\n\n        with upper_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            LEFT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI[\", LEFT(PI_number, 1) + 1, \"-9]\\d[_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        with lower_pi_search = IF(\n            PI_number < 10, \"do not match\",\n            RIGHT(PI_number, 1) = 9, \"do not match\",\n            CONCAT(\"/PI\", LEFT(PI_number, 1), \"[\", RIGHT(PI_number, 1) + 1, \"-9][_\\-](S|SP)\\d[_\\-]/\")\n        ):\n\n        // in future sprint this PI\n        // let s = sprint => if s < 6, then /[s+1 - 6]/\n\n        with sprint_search = IF(\n            sprint_number >= 6, \"do not match\",\n            CONCAT(\"/PI\", PI_number, \"[_\\-](S|SP)[\", sprint_number + 1, \"-6][_\\-]/\")\n        ):\n\n        MATCH(sprint, upper_pi_search)\n            OR MATCH(sprint, lower_pi_search)\n            OR MATCH(sprint, sprint_search)\n    ):\n\n    with scheduledThisSprint = MATCH(sprint, thisSprintPattern):\n\n    with scheduledThisPI = MATCH(sprint, sprintThisPIPattern):\n\n    // Map the results to a variable, which simplifies performing visualization tweaks\n    // 0 -- don't show anything\n    // 1 -- ticket done this sprint\n    // 2 -- ticket cancelled this sprint\n    // 3 -- ticket scheduled this sprint and not a future sprint\n    // 4 -- ticket not scheduled this PI\n    // 5 -- ticket was scheduled this sprint _and_ a future sprint, i.e., it was not completed this sprint\n\n    with result = IF(\n        issuetype != \"User Story\" AND issuetype != \"Issue\", 0,\n        scheduledThisSprint,\n            IF(scheduledFutureSprint, 5,\n                status = \"Done\", 1,\n                status = \"Cancelled\", 2,\n                // else it's just scheduled for this sprint\n                3),\n        NOT scheduledThisPI, \n            IF(status = \"Done\" OR status = \"Cancelled\", 0, \n            4),\n        0\n    ):\n\n    CONCAT(\n        CASE(result,\n            0, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            1, \"{panel:borderStyle=solid|borderColor=white|bgColor=green}{color:white}\",\n            2, \"{panel:borderStyle=solid|borderColor=white|bgColor=silver}{color:white}\",\n            3, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:green}\",\n            4, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\",\n            5, \"{panel:borderStyle=solid|borderColor=white|bgColor=white}{color:black}\"\n        ),\n        IF(any_added_scope_this_sprint, \"[+] \"),\n        CASE(result,\n            0, \"\",\n            1, \"✔\",\n            2, \"✔\",\n            3, \"⚑\",\n            4, \"\",\n            5, \"⚐\"\n        ),\n        IF(any_sp_undefined, \"*\"),\n        // Clear out the styles\n        \"{color}{panel}\"\n    )\n):\n\nIF(\n    issuetype = \"User Story\" OR issuetype = \"Issue\", issue_status,\n    issuetype = \"Feature\", feature_status,\n    summary_status\n)","variables":{"issuetype":{"id":"issuetype","format":"text"},"sprint":{"id":"customfield","params":{"fieldId":10005},"format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"created":{"id":"created","format":"time"},"resolution":{"id":"resolution","format":"text"},"labels":{"id":"labels","format":"text"}},"displayFormat":{"type":"wiki"}}},{"key":"formula","name":"Σ Story Points","csid":"54","params":{"formula":"with any_sp_undefined = SUM{
    (issuetype = "Issue" OR issuetype = "User Story")
        AND ((NOT DEFINED(story_points)) OR story_points = 0) 
        AND (status != "Cancelled" AND status != "Done")
}:

with total_sp = SUM{
    IF((story_points > 0) AND (issuetype = "Issue" OR issuetype = "User Story"), 
        story_points, 0)
}:

with done_sp = SUM{
    IF(DEFINED(resolution) AND story_points > 0 AND (issuetype = "Issue" OR issuetype = "User Story"), 
        story_points, 0)
}:

CONCAT(
    done_sp, " / ", total_sp,
    IF(any_sp_undefined, "*")
)","variables":{"issuetype":{"id":"issuetype","format":"text"},"story_points":{"id":"customfield","params":{"fieldId":10002},"format":"number"},"status":{"id":"status","format":"text"},"resolution":{"id":"resolution","format":"text"}}}},{"key":"actions","csid":"actions","params":{}}],"columnDisplayMode":2,"rowDisplayMode":11,"pins":["1","main"]}